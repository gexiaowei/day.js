# 更新日志

## [未发布]

### 修复

- 修复了 macOS 平台上不支持的 `navigationBarTitleDisplayMode` 和 `navigationBarTrailing` 功能
- 修复公历日期的重复周期计算问题，确保正确显示下一个重复日期的倒计时
- 统一公历日期格式化为 "yyyy 年 MM 月 dd 日" 格式，保持界面一致性
- 修复农历年份计算错误，使用公历年份代替内部计算年份，确保正确显示农历日期
- 修复编译警告：未使用的变量和可以使用常量的变量声明
- 修复在 macOS 平台上使用 AppKit 替代 UIKit，确保图片正确显示
- 修改图片选择为本地文件选择，替代照片库选择，提高兼容性
- 修复本地图片选择功能无法使用的问题，优化按钮交互逻辑
- 修复设置界面在 macOS 上不支持 TabView 页面样式的问题，使用 ZStack 和条件渲染替代
- 优化设置界面选项卡切换，解决卡顿问题，提升用户体验
- 修复设置界面选项卡按钮点击区域问题，确保整个按钮区域都可响应点击
- 修复 Dock 栏图标未正确隐藏的问题，通过添加 Info.plist 设置和应用启动前配置
- 修复顶层表达式编译错误，将隐藏 Dock 图标的代码移至初始化方法中
- 修复 AppDelegate 初始化方法缺少 override 关键字的编译错误
- 修复应用初始化时 NSApp 为 nil 导致的崩溃问题，优化 Dock 图标隐藏逻辑
- 修复 Dock 图标隐藏不彻底的问题，使用 LSUIElement 字符串值 "1" 替代布尔值，并移除运行时设置代码
- 修复 `FeatureRow` 结构体重复声明的问题，统一使用 `SettingsView` 中的定义
- 修复了编译警告：CountdownEvent.swift 中未使用的变量 targetMonth
- 修复了编译警告：LunarDateConverter.swift 中 var nextLunarDay 改为 let，因为它从未被修改
- 修复了工具栏项选中状态更新的代码，使用正确的方法遍历工具栏项并更新图标
- 修复了设置窗口工具栏项图标在切换标签时消失的问题，确保所有图标始终正确显示
- 修复了设置窗口标签页切换功能，优化了工具栏项选中状态的更新逻辑
- 完全重写了设置窗口标签页切换功能，通过创建新的视图实例实现标签切换，解决了无法切换标签的问题
- 彻底重构了设置窗口标签页切换功能，使用 ObservableObject 和 EnvironmentObject 实现响应式标签切换，解决了点击标签无法切换页面的问题
- 修复了类型转换问题，使用 AnyView 包装 SettingsView 并应用 EnvironmentObject，解决了编译错误
- 修复了任务栏图标右键菜单"新增"选项的访问权限问题，通过创建新的 CountdownStore 实例并加载数据解决
- 修复了 ContentView 中 popover 显示问题，统一使用 showingPopover 和 popoverType 变量控制 popover 的显示，解决点击添加按钮和事件卡片无反应的问题

### 添加

- 添加农历和公历选择功能
- 添加重复提醒周期功能（天/月/年）
- 修复农历日期的重复周期计算，正确显示下一个农历日期对应的公历日期
- 添加自定义图片功能，允许用户为提醒事件上传和显示图片
- 优化图片显示为 1:1 比例，提高界面美观度
- 美化事件列表界面，添加卡片阴影、边框和上下文菜单，提升用户体验
- 美化填写事件页面，使用卡片式布局、图形化日期选择器和自定义按钮，提升用户体验
- 添加应用程序 logo
- 添加设置界面，支持通用设置、同步设置和关于信息
- 添加任务栏图标功能，支持左键显示事件列表，右键显示设置和退出选项
- 添加了农历和公历日期选择功能
- 添加了重复提醒周期功能（每日/每月/每年）
- 添加了任务栏图标右键菜单中的"新增"选项，点击可直接打开添加事件页面，提高操作效率

### 变更

- 从主界面移除关于按钮，将关于信息整合到设置界面中
- 移除启动屏幕，提高应用启动速度
- 将应用转为任务栏应用，隐藏 Dock 栏图标，提高系统整洁度
- 恢复设置窗口系统标题栏，移除自定义标题栏，提高系统一致性
- 改进了设置窗口，将标签切换功能移至系统标题栏右侧，并添加了图标和文字描述
- 删除了主界面的搜索事件功能，简化用户界面，提高应用性能
- 重新设计了主界面，移除了 NavigationStack 和 toolbar，将添加按钮移至右下角，设置按钮移至右上角，优化了在 popover 中的显示效果
- 从主界面移除设置按钮，统一通过任务栏图标右键菜单进入设置界面，简化用户界面
- 将主界面的添加按钮从右下角移至右上角，与标题栏集成，优化界面布局和用户体验
- 将事件详情页面从 sheet 模式改为 popover 模式显示，提高在小窗口中的用户体验和视觉连贯性
- 统一所有事件操作（新增/编辑/查看）均使用 popover 模式显示，保持界面一致性和操作流畅性
